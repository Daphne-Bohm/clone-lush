(function ($) {
  Drupal.behaviors.video = {
    attach: function (context, settings) {
      // Autoplay all videos inside hero area.
      var hero_videos = $('.hero video');

      if (hero_videos.length) {
        hero_videos.each(function() {
          $(this).get(0).play();
        })
      }

      $('.video-container').each(function(){
        var container = $(this);
        var isMobile = {
          iOS: function() {
            return /iPhone|iPad|iPod/i.test(navigator.userAgent);
          },
          version: function () {
            return /OS [5-9](.*) like Mac OS X/i.test(navigator.userAgent)
          }
        };

        $('.play-pause', container).on('click touchstart',function(){
          var video = container.find('video');
          var paused = video.get(0).paused;
          if (paused) {
            video.get(0).play();
          }
          else {
            video.get(0).pause();
          }

          container.toggleClass('playing', paused);
        });

        if(isMobile.iOS()) {
          if(isMobile.version()) {
            $('body').addClass('ios-old');
          }
          else {
            $('body').addClass('ios-new');
            $('video').attr({'autoplay':true, 'muted':true, 'playsinline':true });
          }
        }
        else {
          $('body').addClass('other-browsers');
        }
      });
    }
  };
})(jQuery);



